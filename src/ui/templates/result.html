<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Result - Fuzzy Entropy</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    .mode-badge { 
      display: inline-block; 
      padding: 6px 12px; 
      border-radius: 20px; 
      font-weight: 600; 
      font-size: 0.85rem; 
      margin-left: 8px;
    }
    .mode-single { background: #e8f4f8; color: #0c5460; border: 1px solid #bee5eb; }
    .mode-multitask { background: #e8f5e9; color: #1b5e20; border: 1px solid #c8e6c9; }
  </style>
</head>
<body>
  <div class="container py-4">
    <h1 class="mb-3">
      K·∫øt qu·∫£
      {% if 'multitask' in info.lower() %}
        <span class="mode-badge mode-multitask">üîó Multitask</span>
      {% else %}
        <span class="mode-badge mode-single">üìä Single-task</span>
      {% endif %}
    </h1>

    <div class="row">
      <div class="col-md-6">
        <div class="card mb-3">
          <div class="card-header">Input image</div>
          <div class="card-body text-center">
            <img src="{{ img_preview }}" alt="preview" style="max-width:100%; height:auto;">
          </div>
        </div>

        <div class="card mb-3">
          <div class="card-header">Histogram</div>
          <div class="card-body text-center">
            <img src="{{ hist_img }}" alt="histogram" style="max-width:100%; height:auto;">
          </div>
        </div>
      </div>

      <div class="col-md-6">
        <div class="card mb-3">
          <div class="card-header">Metrics</div>
          <div class="card-body">
            <p><strong>Mode:</strong> {{ info }}</p>
            <p><strong>Membership:</strong> {{ membership }}</p>
            <p><strong>Fuzzy Entropy (De Luca-Termini):</strong> <code>{{ "%.4f"|format(fe) if fe else "N/A" }}</code></p>
            
            <!-- Thresholds Display -->
            <div class="mt-3">
              <strong>Ng∆∞·ª°ng (Thresholds):</strong>
              <button class="btn btn-sm btn-outline-primary" type="button" data-bs-toggle="collapse" data-bs-target="#thresholds-detail">
                üìã Xem chi ti·∫øt
              </button>
              <div class="collapse mt-2" id="thresholds-detail">
                {% if thresholds %}
                  <div class="table-responsive">
                    <table class="table table-sm table-striped">
                      <thead>
                        <tr>
                          <th>V·ªã tr√≠</th>
                          <th>Gi√° tr·ªã ng∆∞·ª°ng</th>
                        </tr>
                      </thead>
                      <tbody>
                        {% set thr_list = thresholds.split(',') if thresholds is string else thresholds %}
                        {% for idx, thr in enumerate(thr_list) %}
                          {% if thr %}
                            <tr>
                              <td><code>T[{{ idx }}]</code></td>
                              <td><code>{{ thr.strip() }}</code></td>
                            </tr>
                          {% endif %}
                        {% endfor %}
                      </tbody>
                    </table>
                  </div>
                  <div class="alert alert-info alert-sm mt-2">
                    <small><strong>S·ªë ng∆∞·ª°ng:</strong> {{ thr_list|length }} | <strong>D·∫°ng:</strong> [{{ thresholds }}]</small>
                  </div>
                {% else %}
                  <div class="alert alert-warning alert-sm">Kh√¥ng c√≥ ng∆∞·ª°ng n√†o</div>
                {% endif %}
              </div>
            </div>
          </div>
        </div>

        <a class="btn btn-secondary" href="{{ url_for('index') }}">‚Üê Back</a>
      </div>
    </div>
  </div>
</body>
</html>
